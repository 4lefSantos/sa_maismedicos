uf_sigla %in% c("SC", "RS", "PR") ~ "Permaneceu no sul",
# Do Sudeste para outras regiões
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sudeste e foi para o centro-oeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sudeste e foi para o norte",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do sudeste e foi para o sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do sudeste e foi para o nordeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Permaneceu no sudeste",
TRUE ~ "outros casos"
))
View(base_tratada)
base_tratada <- base_tratada %>%
mutate(regiao_brasil_destino = case_when(
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) ~ "Norte",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) ~ "Nordeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) ~ "Centro-oeste",
(uf_destino %in% c("SC", "RS", "PR")) ~ "Sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) ~ "Sudeste",
TRUE ~ "Outro"))
base_tratada <- base_tratada %>%
mutate(regiao_brasil_exercicio = case_when(
(uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) ~ "Norte",
(uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) ~ "Nordeste",
(uf_sigla %in% c("GO", "MT", "MS", "DF")) ~ "Centro-oeste",
(uf_sigla %in% c("SC", "RS", "PR")) ~ "Sul",
(uf_sigla %in% c("SP", "RJ", "ES", "MG")) ~ "Sudeste",
TRUE ~ "Outro"))
compet2019 <- base_tratada |>
filter(ano == 2019) |>
group_by(CNS_PROF) |>
count()
compet2024 <- base_tratada |>
filter(ano == 2024) |>
group_by(CNS_PROF) |>
count()
View(compet2024)
base_tratada <- base_tratada |>
filter(CNS_PROF %in% intersect(compet2019$CNS_PROF, compet2024$CNS_PROF))
compet2024 <- base_tratada |>
filter(ano == 2024) |>
group_by(CNS_PROF) |>
count()
compet2019 <- base_tratada |>
filter(ano == 2019) |>
group_by(CNS_PROF) |>
count()
tabela_uf_destino <- base_tratada %>%
filter(ano == 2019) %>%
group_by(uf_destino) %>%
summarise(cont_destino = n_distinct(CNS_PROF))
View(tabela_uf_destino)
tabela_uf_destino %>%
ungroup() %>%
summarise(total = sum(cont_destino))
tabela_uf_exercicio <- base_tratada %>%
filter(ano == 2024) %>%
group_by(uf_sigla) %>%
summarise(cont_exercicio = n_distinct(CNS_PROF))
View(tabela_uf_exercicio)
tabela_uf_exercicio %>%
ungroup() %>%
summarise(total = sum(cont_exercicio))
comparativo_uf <- tabela_uf_destino |>
left_join(tabela_uf_exercicio, by = c("uf_destino" = "uf_sigla"))
View(comparativo_uf)
comparativo_uf <- tabela_uf_destino |>
left_join(tabela_uf_exercicio, by = c("uf_destino" = "uf_sigla")) |>
mutate(percentual = cont_exercicio/(cont_destino))
View(comparativo_uf)
tabela_regiao_destino <- base_tratada %>%
filter(ano == 2019) %>%
group_by(regiao_brasil_destino) %>%
summarise(cont_regiao_destino = n_distinct(CNS_PROF))
tipologia_municipal <- read_xlsx("01_dados/tipologia_municipal_rural_urbano.xlsx") |>
mutate(CD_GCMUN = substr(CD_GCMUN,1,6))
base_tratada$CODUFMUN <- as.character(base_tratada$CODUFMUN)
base_tratada <- base_tratada |>
left_join(tipologia_municipal, by = c("CODUFMUN" = "CD_GCMUN")) |>
select(-NM_UF, -SIG_UF, -NM_MUN) |>
rename(tipo_exercicio = TIPO)
base_tratada$tipo_exercicio <- gsub("Rural", "Rural ",base_tratada$tipo_exercicio)
base_tratada$tipo_exercicio <- gsub("Intermediario", "Intermediario ",base_tratada$tipo_exercicio)
base_tratada$municipio_destino <- as.character(base_tratada$municipio_destino)
base_tratada <- base_tratada |>
left_join(tipologia_municipal, by = c("municipio_destino" = "CD_GCMUN")) |>
select(-NM_UF, -SIG_UF, -NM_MUN) |>
rename(tipo_destino = TIPO)
base_tratada$tipo_destino <- gsub("Rural", "Rural ",base_tratada$tipo_destino)
base_tratada$tipo_destino <- gsub("Intermediario", "Intermediario ",base_tratada$tipo_destino)
base_tratada <- base_tratada |>
mutate(migracao_tipo = ifelse((tipo_destino == tipo_exercicio), paste("Permaneceu no", tipo_destino, sep = " "),
paste("Saiu do", tipo_destino, "e foi para o", tipo_exercicio)))
teste <- base_tratada |>
filter(ano == 2024) |>
group_by(migracao_tipo) |>
count() |>
mutate(percentual = n/ sum(n) )
View(teste)
regioes_influencia <- read_xlsx("01_dados/regioes_influencia.xlsx") |>
mutate(codmun = substr(codmun,1,6)) |>
select(codmun, regiao_influencia)
base_tratada <- base_tratada |>
left_join(regioes_influencia, by = c("municipio_destino" = "codmun")) |>
rename(regiao_influencia_destino = regiao_influencia)
base_tratada <- base_tratada |>
left_join(regioes_influencia, by = c("CODUFMUN" = "codmun")) |>
rename(regiao_influencia_exercicio = regiao_influencia)
base_tratada <- base_tratada %>%
mutate(migraçao_regiao_influencia = ifelse(regiao_influencia_destino == regiao_influencia_exercicio,
"Permaneceu na mesma região", "Migrou para outra região"))
retencao_regiao_influencia <- base_tratada %>%
filter(ano == 2024) %>%
group_by(uf_destino, migraçao_regiao_influencia) %>%
count()
View(retencao_regiao_influencia)
retencao_regiao_influencia <- retencao_regiao_influencia |>
pivot_wider(names_from = migraçao_regiao_influencia,  values_from = n) |>
rename(migrou_outra_regiao = `Migrou para outra região`) |>
rename(permaneceu_regiao = `Permaneceu na mesma região`)
View(retencao_regiao_influencia)
teste <- retencao_regiao_influencia |>
mutate(retencao = permaneceu_regiao/(permaneceu_regiao + migrou_outra_regiao))
teste %>%
ggplot(aes(x = n, y = reorder(uf_destino, n), color = migraçao_regiao_influencia)) +
geom_col()
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
View(cns_inscricao)
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
View(maismedicos_completo)
maismedicos_completo |>
group_by(CNS_PROF) |>
count()
teste <- maismedicos_completo |>
group_by(CNS_PROF) |>
count()
View(maismedicos_completo)
View(teste)
View(maismedicos_completo)
base_tratada <- maismedicos_completo |>
filter(COMPETEN >= 201901)
View(base_tratada)
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns"))
View(base_tratada)
base_tratada <- base_tratada |>
filter(COMPETEN >= 201901)
View(base_tratada)
View(base_tratada)
base_tratada$CNS_PROF <- as.character(base_tratada$CNS_PROF)
base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN) |>
cont(competencia_inicio = min(COMPETEN))
base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN) |>
mutate(competencia_inicio = min(COMPETEN))
teste <- base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN) |>
mutate(competencia_inicio = min(COMPETEN))
View(teste)
teste <- base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN) |>
summarise(competencia_inicio = min(COMPETEN))
View(teste)
teste <- base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN) |>
summarise(competencia_inicio = n())
View(teste)
teste <- base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN, CNS_PROF) |>
summarise(competencia_inicio = n())
View(teste)
teste <- base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN, CNS_PROF) |>
ungroup(CNS_PROF) |>
summarise(competencia_inicio = n())
View(teste)
cns_validos <- base_tratada |>
filter(CODUFMUN == municipio_destino, COMPETEN == 201906) |>
select(CNS_PROF) |>
distinct()
View(cns_validos)
cns_validos <- base_tratada |>
filter(CODUFMUN == municipio_destino, COMPETEN == 201905) |>
select(CNS_PROF) |>
distinct()
View(teste)
View(cns_validos)
compet_inicio <- base_tratada |>
filter(CODUFMUN == municipio_destino) |>
group_by(COMPETEN, CNS_PROF) |>
ungroup(CNS_PROF) |>
distinct(CNS_PROF) |>
summarise(competencia_inicio = n())
View(compet_inicio)
cns_validos <- base_tratada |>
filter(CODUFMUN == municipio_destino, COMPETEN == 201906) |>
select(CNS_PROF) |>
distinct()
base_tratada <- base_tratada |>
filter(CNS_PROF == cns_validos$CNS_PROF)
View(base_tratada)
View(cns_validos)
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns"))
base_tratada <- base_tratada |>
filter(COMPETEN >= 201901)
base_tratada$CNS_PROF <- as.character(base_tratada$CNS_PROF)
teste <- base_tratada |>
filter(CNS_PROF == cns_validos$CNS_PROF)
teste <- base_tratada |>
filter(CNS_PROF %in% cns_validos$CNS_PROF)
View(teste)
base_tratada <- base_tratada |>
filter(CNS_PROF %in% cns_validos$CNS_PROF)
View(base_tratada)
base_tratada <- base_tratada |>
filter(CNS_PROF %in% cns_validos$CNS_PROF, COMPETEN >= 201906)
View(base_tratada)
base_tratada <- base_tratada %>%
mutate(regiao_brasil_exercicio = case_when(
(uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) ~ "Norte",
(uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) ~ "Nordeste",
(uf_sigla %in% c("GO", "MT", "MS", "DF")) ~ "Centro-oeste",
(uf_sigla %in% c("SC", "RS", "PR")) ~ "Sul",
(uf_sigla %in% c("SP", "RJ", "ES", "MG")) ~ "Sudeste",
TRUE ~ "Outro"))
View(base_tratada)
View(base_tratada)
teste <- base_tratada |>
select(CNS_PROF, COMPETEN, regiao_brasil_exercicio) |>
arrange(COMPETEN)
View(teste)
base_final <- base_tratada |>
select(CNS_PROF, COMPETEN, regiao_brasil_exercicio) |>
arrange(COMPETEN)
View(base_final)
base_final <- base_final |>
pivot_wider(names_from = COMPETEN, values_from = regiao_brasil_exercicio)
View(base_final)
View(teste)
base_final <- base_tratada |>
select(CNS_PROF, COMPETEN, regiao_brasil_exercicio) |>
arrange(COMPETEN)
duplicados <- teste[!duplicated(teste),]
View(duplicados)
base_final <- base_final[!duplicated(base_final),]
base_final <- base_final |>
pivot_wider(names_from = COMPETEN, values_from = regiao_brasil_exercicio)
View(base_final)
base_final <- base_tratada |>
select(CNS_PROF, COMPETEN, regiao_brasil_exercicio) |>
arrange(COMPETEN)
base_final <- base_final[!duplicated(base_final),]
teste <- base_final |>
group_by(CNS_PROF, COMPETEN) |>
summarise(n = n()) |>
filter(n > 1)
View(teste)
teste <- base_final |>
group_by(CNS_PROF, COMPETEN) |>
summarise(n = n()) |>
distinct(CNS_PROF) |>
filter(n > 1)
teste <- base_final |>
group_by(CNS_PROF, COMPETEN) |>
distinct(CNS_PROF) |>
summarise(n = n()) |>
filter(n > 1)
teste <- base_final |>
group_by(CNS_PROF, COMPETEN) |>
summarise(n = n()) |>
filter(n > 1)
View(teste)
teste2 <- teste |>
select(distinct(CNS_PROF))
View(teste)
teste2 <- teste |>
group_by(CNS_PROF) |>
count() |>
distinct()
View(teste2)
teste <- base_final |>
group_by(CNS_PROF, COMPETEN) |>
summarise(n = n()) |>
filter(n > 1) |>
group_by(CNS_PROF) |>
count() |>
distinct()
View(teste2)
contagem_multregioes <- base_final |>
group_by(CNS_PROF, COMPETEN) |>
summarise(n = n()) |>
filter(n > 1) |>
group_by(CNS_PROF) |>
count() |>
distinct()
View(base_final)
base_final <- base_final |>
filter(!CNS_PROF %in% contagem_multregioes$CNS_PROF)
base_final <- base_tratada |>
select(CNS_PROF, COMPETEN, regiao_brasil_exercicio) |>
arrange(COMPETEN)
base_final <- base_final[!duplicated(base_final),]
contagem_multregioes <- base_final |>
group_by(CNS_PROF, COMPETEN) |>
summarise(n = n()) |>
filter(n > 1) |>
group_by(CNS_PROF) |>
count() |>
distinct()
base_final <- base_final |>
filter(!CNS_PROF %in% contagem_multregioes$CNS_PROF)
base_final <- base_final |>
pivot_wider(names_from = COMPETEN, values_from = regiao_brasil_exercicio)
View(base_final)
View(base_final)
View(base_final)
teste <- base_final |>
mutate(across(2:64, ~ ifelse(is.na(.), "SR", .)))
View(teste)
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
seq <- seqdef(base_final, var = 2:64)
base_final <- base_final |>
mutate(across(2:64, ~ ifelse(is.na(.), "SR", .)))
seq <- seqdef(base_final, var = 2:64)
# Gráfico de estado
seqdplot(seq,
xtlab=1:5,
cex.legend=0.9,
main = "Gráfico de estados",
with.legend = "right")
# Gráfico de estado
seqdplot(seq,
cex.legend=0.9,
main = "Gráfico de estados",
with.legend = "right")
# Gráfico de índices
seqIplot(seq,
main = "Gráficos de índices",
with.legend = "right")
# As dez mais frequentes
seqfplot(seq,
main="Dez mais frequentes",
with.legend = "right")
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
library(TraMineRextras)
View(base_final)
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
seqtab(seq, idx=0) |>
nrow()
View(base_final)
View(base_tratada)
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
library(TraMineRextras)
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
ggseqtrplot(seq +
ggtitle("Gráfico de transição")
install.packages("TraMineR")
installed.packages("TraMineRextras")
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
library(TraMineRextras)
install.packages("TraMineR")
installed.packages("TraMineRextras")
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
library(TraMineRextras)
install.packages("TraMineR")
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
ggseqtrplot(seq,
dss = FALSE) +
ggtitle("Gráfico de transição")
seqplot(seq, type = "transitions", main = "Gráfico de Transição")
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
library(TraMineRextras)
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
library(TraMineRextras)
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
library(readxl)
edital_maismedicos_cns <- read_excel("01_dados/edital_maismedicos_cns.xlsx")
View(edital_maismedicos_cns)
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
library(tidyverse)
library(readxl)
library(geosphere)
library(TraMineR)
library(TraMineRextras)
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx")
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx")
cns_inscricao <- read_excel("01_dados/edital_maismedicos_cns.xlsx")
cns_inscricao <- read_excel("C:/Users/alefs/OneDrive/Documentos/GitHub/sa_maismedicos/01_dados/edital_maismedicos_cns.xlsx")
|>
cns_inscricao <- read_excel("C:/Users/alefs/OneDrive/Documentos/GitHub/sa_maismedicos/01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
cns_inscricao <- read_excel("C:/Users/alefs/OneDrive/Documentos/GitHub/sa_maismedicos/01_dados/edital_maismedicos_cns.xlsx") |>
select(cod_ibge, nome, resultado, uf) |>
rename(cns = resultado) |>
rename(municipio_destino = cod_ibge) |>
rename(uf_destino = uf) |>
mutate(cns = as.numeric(cns))
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
maismedicos_completo <- read_csv("01_dados/maismedicos_completo.csv")
