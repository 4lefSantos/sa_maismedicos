mutate(migracao = case_when((
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "SC" |
uf_sigla == "RS" |
uf_sigla == "PR") ~ "Saiu do norte e foi para o sul"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "SP" | uf_sigla == "RJ" |
uf_sigla == "ES" | uf_sigla == "MG") ~ "Saiu do norte e foi para o sudeste"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "AM" | uf_sigla == "TO" |
uf_sigla == "AP" | uf_sigla == "RR"|
uf_sigla == "PA" | uf_sigla == "RO" |
uf_sigla == "AC") ~ "Permaneceu no norte"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "GO" | uf_sigla = "MT" | uf_sigla = "MS" |
uf_sigla == "DF") ~ "Saiu do norte e foi para o centro-oeste"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "BA" | uf_sigla == "AL" | uf_sigla == "RN" |
uf_sigla == "SE" | uf_sigla = "PI" | uf_sigla == "PB" |
uf_sigla == "CE" | uf_sigla == "PB" | uf_sigla == "MA") ~
"Saiu do norte e para para o nordeste"
TRUE ~ "outros casos")))
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF"="cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade","Outra cidade")) |>
mutate(migracao = case_when((
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "SC" |
uf_sigla == "RS" |
uf_sigla == "PR") ~ "Saiu do norte e foi para o sul"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "SP" | uf_sigla == "RJ" |
uf_sigla == "ES" | uf_sigla == "MG") ~ "Saiu do norte e foi para o sudeste"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "AM" | uf_sigla == "TO" |
uf_sigla == "AP" | uf_sigla == "RR"|
uf_sigla == "PA" | uf_sigla == "RO" |
uf_sigla == "AC") ~ "Permaneceu no norte"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "GO" | uf_sigla = "MT" | uf_sigla = "MS" |
uf_sigla == "DF") ~ "Saiu do norte e foi para o centro-oeste"
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "BA" | uf_sigla == "AL" | uf_sigla == "RN" |
uf_sigla == "SE" | uf_sigla = "PI" | uf_sigla == "PB" |
uf_sigla == "CE" | uf_sigla == "PB" | uf_sigla == "MA") ~
"Saiu do norte e para para o nordeste",
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF"="cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade","Outra cidade")) |>
mutate(migracao = case_when((
(uf_destino == "AM" | uf_destino == "AP" |
uf_destino == "TO" | uf_destino == "AC" |
uf_destino == "RR" | uf_destino == "RO" |
uf_destino == "PA") &
(uf_sigla == "SC" |
uf_sigla == "RS" |
uf_sigla == "PR") ~ "Saiu do norte e foi para o sul",
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF"="cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade", "Outra cidade")) |>
mutate(migracao = case_when(
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do norte e foi para o sul",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do norte e foi para o sudeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("AM", "TO", "AP", "RR", "PA", "RO", "AC") ~ "Permaneceu no norte",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do norte e foi para o centro-oeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do norte e foi para o nordeste",
TRUE ~ "outros casos"
))
View(base_tratada)
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade", "Outra cidade")) |>
mutate(migracao = case_when(
# Do Norte para outras regiões
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do norte e foi para o sul",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do norte e foi para o sudeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do norte e foi para o centro-oeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("AM", "TO", "AP", "RR", "PA", "RO", "AC") ~ "Permaneceu no norte",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do norte e foi para o nordeste",
# Do Nordeste para outras regiões
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do nordeste para o sul",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do nordeste e foi para o sudeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do nordeste e foi para o centro-oeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Permaneceu no nordeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do nordeste e foi para o norte",
# Do Centro-Oeste para outras regiões
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do centro-oeste e foi para o sul",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do centro-oeste e foi para o sudeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do centro-oeste e foi para o nordeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do centro-oeste e foi para o norte",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Permaneceu no centro-oeste",
# Do Sul para outras regiões
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do sul e foi para o sudeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_destino %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sul e foi para o centro-oeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sul e foi para o norte",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do sul e foi para o nordeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Permaneceu no sul",
# Do Sudeste para outras regiões
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sudeste e foi para o centro-oeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sudeste e foi para o norte",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_destino %in% c("SC", "RS", "PR") ~ "Saiu do sudeste e foi para o sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do sudeste e foi para o nordeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Permaneceu no sudeste",
TRUE ~ "outros casos"
))
View(base_tratada)
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade", "Outra cidade")) |>
mutate(migracao = case_when(
# Do Norte para outras regiões
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do norte e foi para o sul",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do norte e foi para o sudeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do norte e foi para o centro-oeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("AM", "TO", "AP", "RR", "PA", "RO", "AC") ~ "Permaneceu no norte",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do norte e foi para o nordeste",
# Do Nordeste para outras regiões
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do nordeste para o sul",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do nordeste e foi para o sudeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do nordeste e foi para o centro-oeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Permaneceu no nordeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do nordeste e foi para o norte",
# Do Centro-Oeste para outras regiões
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do centro-oeste e foi para o sul",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do centro-oeste e foi para o sudeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do centro-oeste e foi para o nordeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do centro-oeste e foi para o norte",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Permaneceu no centro-oeste",
# Do Sul para outras regiões
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do sul e foi para o sudeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sul e foi para o centro-oeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sul e foi para o norte",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do sul e foi para o nordeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Permaneceu no sul",
# Do Sudeste para outras regiões
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sudeste e foi para o centro-oeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sudeste e foi para o norte",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do sudeste e foi para o sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do sudeste e foi para o nordeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Permaneceu no sudeste",
TRUE ~ "outros casos"
))
View(base_tratada)
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade", "Outra cidade")) |>
mutate(migracao = case_when(
# Do Norte para outras regiões
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do norte e foi para o sul",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do norte e foi para o sudeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do norte e foi para o centro-oeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("AM", "TO", "AP", "RR", "PA", "RO", "AC") ~ "Permaneceu no norte",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do norte e foi para o nordeste",
# Do Nordeste para outras regiões
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do nordeste para o sul",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do nordeste e foi para o sudeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do nordeste e foi para o centro-oeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Permaneceu no nordeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do nordeste e foi para o norte",
# Do Centro-Oeste para outras regiões
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do centro-oeste e foi para o sul",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do centro-oeste e foi para o sudeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do centro-oeste e foi para o nordeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do centro-oeste e foi para o norte",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Permaneceu no centro-oeste",
# Do Sul para outras regiões
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do sul e foi para o sudeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sul e foi para o centro-oeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sul e foi para o norte",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do sul e foi para o nordeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Permaneceu no sul",
# Do Sudeste para outras regiões
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sudeste e foi para o centro-oeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sudeste e foi para o norte",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do sudeste e foi para o sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA") ~ "Saiu do sudeste e foi para o nordeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Permaneceu no sudeste",
TRUE ~ "outros casos"
))
View(base_tratada)
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade", "Outra cidade")) |>
mutate(migracao = case_when(
# Do Norte para outras regiões
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do norte e foi para o sul",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do norte e foi para o sudeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do norte e foi para o centro-oeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("AM", "TO", "AP", "RR", "PA", "RO", "AC") ~ "Permaneceu no norte",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do norte e foi para o nordeste",
# Do Nordeste para outras regiões
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do nordeste para o sul",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do nordeste e foi para o sudeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do nordeste e foi para o centro-oeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Permaneceu no nordeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do nordeste e foi para o norte",
# Do Centro-Oeste para outras regiões
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do centro-oeste e foi para o sul",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do centro-oeste e foi para o sudeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do centro-oeste e foi para o nordeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do centro-oeste e foi para o norte",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Permaneceu no centro-oeste",
# Do Sul para outras regiões
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do sul e foi para o sudeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_destino %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sul e foi para o centro-oeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sul e foi para o norte",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do sul e foi para o nordeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Permaneceu no sul",
# Do Sudeste para outras regiões
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sudeste e foi para o centro-oeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sudeste e foi para o norte",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_destino %in% c("SC", "RS", "PR") ~ "Saiu do sudeste e foi para o sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do sudeste e foi para o nordeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Permaneceu no sudeste",
TRUE ~ "outros casos"
))
View(base_tratada)
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade", "Outra cidade")) |>
mutate(migracao = case_when(
# Do Norte para outras regiões
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do norte e foi para o sul",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do norte e foi para o sudeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do norte e foi para o centro-oeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("AM", "TO", "AP", "RR", "PA", "RO", "AC") ~ "Permaneceu no norte",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do norte e foi para o nordeste",
# Do Nordeste para outras regiões
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do nordeste para o sul",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do nordeste e foi para o sudeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do nordeste e foi para o centro-oeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Permaneceu no nordeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do nordeste e foi para o norte",
# Do Centro-Oeste para outras regiões
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do centro-oeste e foi para o sul",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do centro-oeste e foi para o sudeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do centro-oeste e foi para o nordeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do centro-oeste e foi para o norte",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Permaneceu no centro-oeste",
# Do Sul para outras regiões
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do sul e foi para o sudeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sul e foi para o centro-oeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sul e foi para o norte",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do sul e foi para o nordeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Permaneceu no sul",
# Do Sudeste para outras regiões
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sudeste e foi para o centro-oeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sudeste e foi para o norte",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do sudeste e foi para o sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do sudeste e foi para o nordeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Permaneceu no sudeste",
TRUE ~ "outros casos"
))
View(base_tratada)
base_tratada <-
maismedicos_completo |>
left_join(cns_inscricao, by = c("CNS_PROF" = "cns")) |>
mutate(COMPETEN = as.character(COMPETEN)) |>
mutate(ano = substr(COMPETEN, 1, 4)) |>
filter(COMPETEN == '201906' | COMPETEN == '202406') |>
mutate(mesma_cidade = if_else((municipio_destino == CODUFMUN), "Mesma cidade", "Outra cidade")) |>
mutate(mesmo_estado = if_else((uf_destino == uf_sigla), "Mesmo estado", "Outro estado")) |>
mutate(migracao = case_when(
# Do Norte para outras regiões
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do norte e foi para o sul",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do norte e foi para o sudeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do norte e foi para o centro-oeste",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("AM", "TO", "AP", "RR", "PA", "RO", "AC") ~ "Permaneceu no norte",
(uf_destino %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do norte e foi para o nordeste",
# Do Nordeste para outras regiões
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do nordeste para o sul",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do nordeste e foi para o sudeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do nordeste e foi para o centro-oeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Permaneceu no nordeste",
(uf_destino %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do nordeste e foi para o norte",
# Do Centro-Oeste para outras regiões
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do centro-oeste e foi para o sul",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do centro-oeste e foi para o sudeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do centro-oeste e foi para o nordeste",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do centro-oeste e foi para o norte",
(uf_destino %in% c("GO", "MT", "MS", "DF")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Permaneceu no centro-oeste",
# Do Sul para outras regiões
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Saiu do sul e foi para o sudeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sul e foi para o centro-oeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sul e foi para o norte",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do sul e foi para o nordeste",
(uf_destino %in% c("SC", "RS", "PR")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Permaneceu no sul",
# Do Sudeste para outras regiões
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("GO", "MT", "MS", "DF") ~ "Saiu do sudeste e foi para o centro-oeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("AM", "AP", "TO", "AC", "RR", "RO", "PA") ~ "Saiu do sudeste e foi para o norte",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SC", "RS", "PR") ~ "Saiu do sudeste e foi para o sul",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("BA", "AL", "RN", "SE", "PI", "PB", "CE", "MA", "PE") ~ "Saiu do sudeste e foi para o nordeste",
(uf_destino %in% c("SP", "RJ", "ES", "MG")) &
uf_sigla %in% c("SP", "RJ", "ES", "MG") ~ "Permaneceu no sudeste",
TRUE ~ "outros casos"
))
